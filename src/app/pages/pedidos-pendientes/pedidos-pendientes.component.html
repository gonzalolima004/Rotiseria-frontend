
<div class="body">
<div class="contenedor-pedidos">
  <div class="titulo-con-flechas">
    <button class="flecha" (click)="obtenerPedidos()">&#x21bb;</button>
    <h2>Pedidos Pendientes</h2>
    <span class="contador-badge">
      ğŸ§¾ {{ cantidadPendientes() }} Pendientes
    </span>
  </div>

  <div *ngIf="cargando" class="cargando">
    <div class="spinner"></div>
    <p>Cargando pedidos...</p>
  </div>

  <div class="tabla-wrapper" *ngIf="!cargando && pedidos.length > 0">
    <table class="tabla-pedidos">
      <thead>
        <tr>
          <th>NÃºmero / Fecha</th>
          <th>Cliente</th>
          <th>Detalle del Pedido</th>
          <th>Total</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let pedido of pedidos" class="fila-pedido" [class.fila-eliminando]="pedido.id_pedido === eliminandoId">
          <td>
            <div class="numero-pedido">#{{ pedido.id_pedido }}</div>
            <div class="fecha-pedido">
              {{ pedido.fecha_hora | date: 'dd/MM/yyyy HH:mm' }}
            </div>
          </td>

          <td>
            <div class="nombre-cliente">{{ pedido.cliente?.nombre_cliente }}</div>
            <div class="info-cliente">ğŸ“ {{ pedido.cliente?.telefono_cliente }}</div>
            <div class="info-cliente">ğŸ“ {{ pedido.cliente?.direccion_cliente }}</div>
            <div class="info-cliente">ğŸªª DNI: {{ pedido.cliente?.dni_cliente }}</div>
          </td>

          <td>
            <div *ngIf="pedido.detalles?.length > 0; else sinDetalles">
              <div *ngFor="let det of pedido.detalles" class="detalle-item">
                <div class="detalle-linea">
                  <span class="detalle-label">ğŸ• Producto:</span>
                  <span class="detalle-valor">{{ det.producto?.nombre_producto }}</span>
                </div>
                <div class="detalle-linea">
                  <span class="detalle-label">Cantidad:</span>
                  <span class="detalle-valor">{{ det.cantidad }}</span>
                </div>
                <div class="detalle-linea">
                  <span class="detalle-label">Subtotal:</span>
                  <span class="detalle-precio">
                    {{ det.subtotal | currency:'ARS':'symbol-narrow' }}
                  </span>
                </div>
              </div>
            </div>
            <ng-template #sinDetalles>
              <div class="sin-datos-detalle">Sin detalles</div>
            </ng-template>
          </td>

          <td>
            <div class="total">
              {{ pedido.monto_total | currency:'ARS':'symbol-narrow' }}
            </div>
          </td>

          <td class="acciones">
            <button class="btn-aprobar" (click)="confirmarPedido(pedido)">
              âœ… Aprobar
            </button>
            <button class="btn-rechazar" (click)="rechazarPedido(pedido)">
              âŒ Rechazar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!cargando && pedidos.length === 0" class="sin-datos">
    <div class="sin-datos-icono">ğŸ“¦</div>
    <p>No hay pedidos pendientes por el momento.</p>
  </div>
</div>
</div>